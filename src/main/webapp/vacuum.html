<!DOCTYPE html>
<html>
    <head>
        <title>Trending demo</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script src="//cdnjs.cloudflare.com/ajax/libs/dygraph/1.1.1/dygraph-combined.js"></script>
        <script src="//code.jquery.com/jquery-1.12.0.min.js"></script>
        <style>
            .dygraph-title {
                color: gray;
            }
            #graph {
                width: 1000px;
                height: 400px;
            }
        </style>
    </head>
    <body>
        <div id="graph"></div>
        <script type="text/javascript">
            g = new Dygraph(
                    document.getElementById("graph"), [[new Date("2017-05-28T05:52:46Z"), 0, 0, 0], [new Date("2017-05-29T05:52:46Z"), 1, 1, 1]], {
                // options go here. See http://dygraphs.com/options.html 
                legend: 'always',
                animatedZooms: true,
                title: 'Time History',
                connectSeparatedPoints: true,
                drawPoints: true,
                labels: ["time", "a", "b", "c", "pressure"],
                series: {
                    'pressure' : {
                        axis: 'y2'
                    }
                },
                zoomCallback: function (minDate, maxDate, yRanges) {
                    console.log(minDate + " " + maxDate + " " + yRanges);
                    var args = $.param({"key": [1201, 1202, 1203, 1215], "t1": Math.round(minDate), "t2": Math.round(maxDate), "n": 100}, true);
                    $.getJSON("rest", args).done(function (newData) {
                        for (var i = 0; i < newData.length; i++) {
                            newData[i][0] = new Date(newData[i][0]);
                        }
                        g.updateOptions({file: newData});
                    })
                            .fail(function (jqXHR, message) {
                                alert("error " + message);
                            });
                }
            });
            var args = $.param({"key": [1201, 1202, 1203, 1215], "t1": 1495832400000, "t2": 1495854000000, "n": 100}, true);
            $.getJSON("rest", args).done(function (newData) {
                for (var i = 0; i < newData.length; i++) {
                    newData[i][0] = new Date(newData[i][0]);
                }
                g.updateOptions({file: newData});
            })
                    .fail(function (jqXHR, message) {
                        alert("error " + message);
                    });
        </script>
    </body>

</html>